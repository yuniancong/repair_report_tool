# 维修单工具 Modern Edition v2.0

一个现代化的维修报告生成工具，具有 RepoPrompt 风格的半透明玻璃态界面。

## ✨ 特性

- 🎨 **现代化 UI** - 采用 CustomTkinter 框架，具有玻璃态效果和半透明设计
- 📋 **项目管理** - 轻松创建、编辑和管理多个维修项目
- 🖼️ **图片管理** - 支持拖放、批量添加和预览图片
- 📊 **Excel 导出** - 生成带图片的专业 Excel 报告
- 📄 **PDF 导出** - 生成格式化的 PDF 文档
- 💾 **项目保存** - JSON 格式保存和加载项目
- 🌗 **深色/浅色模式** - 支持系统主题切换

## 🚀 快速开始

### 安装依赖

```bash
pip install -r requirements.txt
```

### 运行程序

```bash
python repair_report_modern.py
```

或者使用启动脚本：

```bash
python launcher.py
```

## 📦 依赖说明

### 必需依赖

- **customtkinter** - 现代化的 Tkinter UI 框架
- **Pillow** - 图像处理库

### 可选依赖

- **openpyxl** - Excel 导出功能
- **reportlab** - PDF 导出功能
- **tkinterdnd2** - 拖放功能支持

如果缺少可选依赖，相应的功能将被禁用，但核心功能仍可正常使用。

## 🎨 UI 设计特点

### RepoPrompt 风格

- **玻璃态效果** - 半透明面板和模糊背景
- **圆角设计** - 所有组件采用圆角边框
- **现代配色** - 深色主题，蓝色强调色
- **流畅动画** - 平滑的过渡效果
- **悬停反馈** - 按钮和卡片的悬停状态

### 布局结构

```
┌─────────────────────────────────────────────────────────────┐
│  🔧 维修单工具 Modern Edition    [项目标题输入]  [Excel] [PDF] │
├───────────────┬─────────────────────────────────────────────┤
│               │                                             │
│  维修项目      │  项目描述                                    │
│  [+ 添加]      │  [输入框]                                    │
│               │                                             │
│  🔍 搜索...    │  图片管理  [📸 添加图片] [📁 批量添加]          │
│               │                                             │
│  ┌─────────┐  │  ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐          │
│  │ 项目 1   │  │  │     │ │     │ │     │ │     │          │
│  │ 📷 3 张  │  │  │ 图片 │ │ 图片 │ │ 图片 │ │ 图片 │          │
│  └─────────┘  │  │     │ │     │ │     │ │     │          │
│               │  └─────┘ └─────┘ └─────┘ └─────┘          │
│  ┌─────────┐  │                                             │
│  │ 项目 2   │  │                                             │
│  │ 📷 2 张  │  │                                             │
│  └─────────┘  │                                             │
│               │                                             │
│  0 项目 • 0图片 │                                             │
│               │                                             │
│  [📁 打开]     │                                             │
│  [💾 保存]     │                                             │
├───────────────┴─────────────────────────────────────────────┤
│  就绪                                  ✓ 拖拽 ✓ Excel ✓ PDF  │
└─────────────────────────────────────────────────────────────┘
```

## 🔧 功能说明

### 项目管理

1. **创建项目** - 点击侧边栏的"+ 添加"按钮
2. **编辑描述** - 在主区域输入项目描述
3. **删除项目** - 点击项目卡片上的垃圾桶图标
4. **选择项目** - 点击项目卡片

### 图片管理

1. **添加图片** - 点击"📸 添加图片"选择单个或多个图片
2. **批量添加** - 点击"📁 批量添加"批量选择图片
3. **拖放图片** - 直接拖放图片文件到窗口（需要 tkinterdnd2）
4. **删除图片** - 点击图片卡片下方的"删除"按钮

### 导出功能

#### Excel 导出

- 生成专业的 Excel 表格
- 包含项目标题、时间戳
- 自动插入调整大小的图片
- 表格格式化和边框

#### PDF 导出

- 生成 A4 格式的 PDF 文档
- 智能图片布局（1列、2列或3列）
- 支持中文字体
- 自动分页

### 项目保存/加载

- **保存** - 将项目保存为 JSON 文件
- **打开** - 从 JSON 文件加载项目
- 包含所有项目数据和图片路径

## ⚙️ 设置

点击右上角的 ⚙️ 按钮访问设置：

- **外观模式** - 切换深色/浅色/系统主题
- **系统信息** - 查看系统和依赖状态

## 🐛 故障排除

### CustomTkinter 未安装

```bash
pip install customtkinter
```

### 拖放功能不可用

```bash
# macOS
brew install tkdnd
pip install tkinterdnd2

# Linux
sudo apt-get install python3-tk
pip install tkinterdnd2
```

### 中文字体显示问题

确保系统已安装中文字体：

- **Windows** - 默认支持
- **macOS** - 默认支持
- **Linux** - 安装 `fonts-wqy-microhei` 或 `fonts-wqy-zenhei`

## 🆚 与原版对比

| 特性 | 原版 | Modern Edition |
|------|------|----------------|
| UI 框架 | Tkinter | CustomTkinter |
| 外观 | 传统 | 现代玻璃态 |
| 主题 | 系统默认 | 深色/浅色可切换 |
| 动画效果 | 无 | 平滑过渡 |
| 移动设备支持 | 否 | 否 |
| 功能完整性 | ✓ | ✓ |
| 性能 | 良好 | 良好 |

## 📝 版本历史

### v2.0.0 (2024)

- 🎨 全新的 RepoPrompt 风格 UI
- 💎 玻璃态和半透明效果
- 🎯 改进的用户体验
- 📱 现代化的组件库
- ⚡ 优化的性能

### v1.7.4 (原版)

- 基础 Tkinter UI
- 完整的导出功能
- 拖放支持

## 🤝 贡献

欢迎提交问题和功能建议！

## 📄 许可证

MIT License

## 👨‍💻 作者

维修单工具开发团队

---

**注意**: 这是现代化重构版本，与原版 (`repair_report_tool-11.py`) 功能兼容，但 UI 完全重新设计。
